webpackJsonp([0],{0:function(t,e){function r(t){throw new Error("Cannot find module '"+t+"'.")}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=0},5:function(t,e,r){function i(){$(".nomore").show()}r(1);!function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}(),function(){var t=new Error('Cannot find module "."');throw t.code="MODULE_NOT_FOUND",t}();var s=function(){function t(t){this.$wrapper=$(t),this.bar=new e(this,this.$wrapper.find(".bar")),this.suggester=new r(this,this.$wrapper.find(".fixsearch-suggester")),this.predictor=new s(this,this.$wrapper.find(".fixsearch-predictor")),this.result=1===$(".search-result").length?new a(this,$(".search-result")):null}function e(t,e){this._search=t,this.$wrapper=e,this.$input=e.find("input"),this.$search=e.find(".js-btn-search"),t.regEvent("focus","input",function(t){var e=this._search.suggester;0===e.lastUpdate&&e.fetch(),this.setActive(!0),this.getKeyword()||this._search.predictor.hide(),e.show()}.bind(this)),t.regEvent("click",".js-btn-back",function(){this._search.result?location.href="/":(this._search.bar.setActive(!1).$input.val(""),this._search.suggester.hide(),this._search.predictor.hide())}.bind(this)),t.regEvent("click",".js-btn-search",function(t){var e=this.getKeyword();location.href="/search.html?q="+e}.bind(this)),t.regEvent("keypress","input",function(t){(t.key&&"Enter"===t.key||13===t.which)&&this._search.bar.$search.click()}.bind(this))}function r(t,e){this._search=t,this.$wrapper=e,this.$ul=e.find("ul"),this.lastUpdate=0,this.data=null,this.fetch(),t.regEvent("click",".suggest",function(t){this._search.bar.setKeyword($(t.target).text(),!0)}.bind(this))}function s(t,e){this._search=t,this.$wrapper=e,this.$ul=e.find("ul"),this.data=null,this.timer=null,t.regEvent("click",".prediction",function(t){this._search.bar.setKeyword($(t.currentTarget).find("span").text(),!0)}.bind(this))}function a(t,e){this._search=t,this.$wrapper=e,this.$empty=e.find(".empty-prompt"),this.$grid=e.find(".grid"),this.toolbar=new h(this,e.find(".toolbar")),this.param=d(),this.isLoading=!1,this.prevLoading=0,this.noMore=!1,this.param.q&&t.bar.setKeyword(this.param.q),this.toolbar.state(this.param),this.fetch(),this.toolbar.$wrapper.on("click","button",function(t){switch($(t.currentTarget).attr("data-type")){case"default":this.param.sort=null;break;case"price":this.param.sort="asc"===this.param.sort?"desc":"asc";break;case"availability":this.param.stock=+this.param.stock?0:1}this.noMore=!1,this.param.page=1,this.toolbar.state(this.param),$(".nomore").hide(),this.fetch()}.bind(this)),$(document).on("scroll.search-result.more",this.more.bind(this))}function n(t,e,r){var i=[],s=[],a=[];t.forEach(function(t,e){a.push(t.itemId),e%2==0?s=[t]:(s.push(t),i.push(s),s=[])}),s.length&&i.push(s),r||e.html(""),i.forEach(function(t,r){var i=$("<div/>").addClass("rows");new c(t[0]).$wrapper.addClass("col1").appendTo(i),t[1]&&new c(t[1]).$wrapper.addClass("col2").appendTo(i),e.append(i)}),a.length>0&&o(a.join(","),3)}function o(t,e){e--,$.ajax({type:"post",url:"/product/getPrice",dataType:"json",data:{skus:t},success:function(r){if(r&&r.isSuccess&&r.data){for(var i=[],s=0;s<r.data.length;s++)$('[name="sku_price_'+r.data[s].id+'"]').length>1&&console.log(r.data[s].id),Number(r.data[s].p)>Number("0.00")?$('[name="sku_price_'+r.data[s].id+'"]').html("￥"+r.data[s].p):$('[name="sku_price_'+r.data[s].id+'"]').html("暂无报价"),i.push(r.data[s].id);for(var a=t.split(","),s=0;s<a.length;s++){for(var n=!1,h=0;h<i.length;h++)if(a[s]==i[h]){n=!0;break}n||$('[name="sku_price_'+a[s]+'"]').html("暂无报价")}}else e>0&&o(t,e)},error:function(t){qk.dialog.alert("抱歉，网络繁忙，请稍后再试")}})}function h(t,e){this._result=t,this.$wrapper=e,this._state={sort:"default",filterByStock:!1}}function c(t){this.$wrapper=$("<a>").attr({href:"/item.html?itemId="+t.itemId,target:"_self"}),this.$wrapper.append($("<img>").attr("src",t.itemImgSrc)),$("img").error(function(){$(this).attr("src","//static.i360mall.com/h5/images/default_img_100.jpg")}),this.$wrapper.append($("<span>").text(t.itemName)),this.$wrapper.append($('<em name="sku_price_'+t.itemId+'">').text("")),1!=t.status&&this.$wrapper.append($("<strong>").text("无货")),this.$wrapper=$('<div class="item">').append(this.$wrapper)}function p(t){return"string"==typeof t?JSON.parse(t):t}function d(){var t={};return location.search.slice(1).split("&").forEach(function(e){var r=e.split("=");t[r[0]]=r[1]?decodeURI(r[1]):""}),t}var u={searchUrl:"/query",suggestUrl:"/hotWords",predictUrl:"",predictDelay:500};t.prototype.regEvent=function(t,e,r){this.$wrapper.on(t,e,r)},e.prototype.setActive=function(t){return this.$wrapper.toggleClass("active",t),this},e.prototype.setKeyword=function(t,e){return this.$input.val(t),e&&this.$search.click(),this},e.prototype.getKeyword=function(){return this.$input.val().trim()},r.prototype.show=function(){return this.$wrapper.show(),this},r.prototype.hide=function(){return this.$wrapper.hide(),this},r.prototype.fetch=function(){$.ajax({url:u.suggestUrl,success:function(t){this.lastUpdate=Date.now(),this.data=p(t).data,this.render()}.bind(this)})},r.prototype.render=function(){var t=[];for(var e in this.data)""!=$.trim(this.data[e].name)&&t.push($('<li class="suggest">').text(this.data[e].name));return this.$ul.html("").append(t),this},s.prototype.show=function(){return this.$wrapper.show(),this},s.prototype.hide=function(){return this.$wrapper.hide(),this},s.prototype.fetch=function(){$.ajax({url:u.predictUrl+"?q="+this._search.bar.getKeyword(),dataType:"jsonp",success:function(t){this.data=p(t).data,this.render()}.bind(this)})},s.prototype.render=function(){var t,e=this._search.bar.getKeyword(),r=[];for(t in this.data)if(Object.prototype.hasOwnProperty.call(this.data,t)){var i=t.replace(e,"<strong>"+e+"</strong>");r.push($('<li class="prediction icon-search">').append($("<span>").html(i),$("<em>").text("约"+this.data[t]+"件")))}return this.$ul.html("").append(r),this};var l=!0;return a.prototype.fetch=function(t){$.ajax({url:u.searchUrl,dataType:"json",data:this.param,success:function(e){e&&e.isSuccess&&e.data?(this.data=e.data,0!==this.data.totalCount&&$.each(this.data.searchItems,function(t,e){l=1==e.status}),this.render(t),this.isLoading=!1):qk.dialog.alert(e.message)}.bind(this)})},a.prototype.more=function(){var t=Date.now(),e=$(window).scrollTop()+$(window).height()>=$(document).height()-$(window).height();(!this.prevLoading||t-this.prevLoading>200)&&(this.isLoading||this.noMore||!e||(this.isLoading=!0,this.param.page=(this.param.page||1)+1,this.fetch(!0)),this.prevLoading=t)},a.prototype.render=function(t){var e=$("#search_keyword").val(),r=this.$grid;0==this.data.totalCount?(l&&this.toolbar.hide(),r.html(""),this.$empty.show().find(".prompt").text("您搜的“"+e+"”没有找到")):this.data.searchItems&&this.data.searchItems.length>0?(this.$empty.hide(),n(this.data.searchItems,r,t)):(this.noMore=!0,i())},h.prototype.hide=function(){return this.$wrapper.hide(),this},h.prototype.state=function(t){return t?(this._state.sort=t.sort||this._state.sort,this._state.filterByStock=t.stock,this.$wrapper.find(".sort.active").removeClass("active"),"default"!==this._state.sort?this.$wrapper.find("[data-type=price]").attr("data-value",this._state.sort).addClass("active"):this.$wrapper.find("[data-type=default]").addClass("active"),this.$wrapper.find(".filter").attr("data-value",this._state.filterByStock||0),this):$.extend({},this._state)},t}();new s(".fixsearch");$(function(){qk&&qk.sellNav.init()})}},[5]);